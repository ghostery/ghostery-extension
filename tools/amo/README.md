# Ghostery Source Code Builder for AMO Review

This package includes source code for the Ghostery extension along with Ghostery common libraries. Although ghostery-common is included in the Ghostery project as an NPM dependency, we provide the full source code here for easier review.

## `build.sh`

Use this script to install dependencies and build production code for the Ghostery Common and Ghostery Extension projects. It is intended to be run inside the `ghostery-source` directory generated by `generate.sh`.

#### Requirements

This build script was tested on macOS Mojave with the following configuration:

+ [Homebrew](https://brew.sh/)
+ [nvm](https://github.com/nvm-sh/nvm")
	+ `brew install nvm`
+ [Yarn](https://yarnpkg.com/)
	+ `brew install yarn`
+ [jq](https://stedolan.github.io/jq/)
	+ `brew install jq`

#### Notes on `common-X.X.X`

After running `build.sh`, you should see the production files in the `common-X.X.X/build/` directory. This should match the code found in `ghostery-extension-X.X.X/node_modules/ghostery-common/build/`.

#### Notes on `ghostery-extension-X.X.X`

After running `build.sh`, you should see the production build archive in the `ghostery-extension-X.X.X/build/` directory. This file should match the archive that was submitted to AMO.

Compiled assets live in the `ghostery-extension-X.X.X/dist/` folder. Assets from Ghostery Common (see above) are copied into the `ghostery-extension-X.X.X/common/` directory from `node_modules/ghostery-common/build/assets` using the `vendor-copy` npm package. That copy is triggered when running `yarn install`. See `package.json`:

```json
"vendorCopy": [
   {
      "from": "node_modules/ghostery-common/build/assets",
      "to": "common"
    }
]
```

## `generate.sh`

Fetches source code from GitHub and packages it along with `build.sh` and this README. This creates the complete source code archive that Ghostery sends along with its AMO submissions.
